!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@iosio/util"),require("@iosio/obi")):"function"==typeof define&&define.amd?define(["exports","@iosio/util","@iosio/obi"],t):t((n=n||self).iosiox={},n.util,n.obi)}(this,function(n,t,r){"use strict";function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function i(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}function u(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&f(n,t)}function o(n){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function f(n,t){return(f=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function c(n,t,r){return(c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}()?Reflect.construct:function(n,t,r){var e=[null];e.push.apply(e,t);var i=new(Function.bind.apply(n,e));return r&&f(i,r.prototype),i}).apply(null,arguments)}function l(n){var t="function"==typeof Map?new Map:void 0;return(l=function(n){if(null===n||(r=n,-1===Function.toString.call(r).indexOf("[native code]")))return n;var r;if("function"!=typeof n)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(n))return t.get(n);t.set(n,e)}function e(){return c(n,arguments,o(this).constructor)}return e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),f(e,n)})(n)}function a(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function s(n,t){return!t||"object"!=typeof t&&"function"!=typeof t?a(n):t}function v(n){return function(n){if(Array.isArray(n)){for(var t=0,r=new Array(n.length);t<n.length;t++)r[t]=n[t];return r}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var h=document,y=function(n){return h.createElement(n)},b=function(n,t){return n.appendChild(t)},d=function(n){return h.createTextNode(n)},p=function(n){var t=y("style");return b(t,d("")),b(n||h.head,t),function(n){return b(t,d(n)),t}},m=p(),w=p(),g=function(n,r,e){var i,u;null===e||!1===e?n.removeAttribute(r):n.setAttribute(r,(i=n).getAttribute&&i.localName&&(u=i.getAttribute("is"),i.localName.includes("-")||u&&u.includes("-"))&&(t.isObj(e)||t.isArray(e))?JSON.stringify(e):e)};w(" .___ {visibility: inherit;}",!0);var j=function(n,t){return n.removeChild(t)},k=function(n,t,r){return n.insertBefore(t,r)},O=function(n){return n.toLowerCase()},A={},x=[],R=x.map,S="#document-fragment",_=function(n,t,r){for(var e in r={},n)r[e]=n[e];for(var e in t)r[e]=t[e];return r},E=function(n){this.handlers[n.type](n)},N=function n(r){var e;(e=[]).concat.apply(e,v(r.childNodes)).forEach(function(r){if(r.handlers)for(var e in r.handlers)t.removeListener(r,e,E);n(r)})},C=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,T=function(n,t,r){"-"===t[0]?n.setProperty(t,r):n[t]="number"==typeof r&&!1===C.test(t)?r+"px":r},M=function(n,r,e){return function(n){return n?n.split(/\s+/).filter(function(n){return n}):[]}(t.isObj(r)?function(n,t){for(var r in t="",n)n[r]&&(t+=(t&&" ")+r);return t}(r):r).forEach(function(t){return n.classList[e](t)})},q=function(n,r,e,i,u){if("key"===r);else if(!t.isFunc(i)||!r.startsWith("on")||r in n)"ref"===r&&t.isFunc(i)?i(n):"style"===r?function(r,e,i,u){if(u=n.style,t.isString(e))return u.cssText=e;if(t.isString(i)&&(u.cssText="",i=null),i)for(var o in i)e&&o in e||T(u,o,"");if(e)for(var f in e)i&&e[f]===i[f]||T(u,f,e[f])}(0,i,e):"className"===r||"class"===r?(M(n,e,"remove"),M(n,i,"add")):!u&&"list"!==r&&r in n?n[r]=null==i?"":i:g(n,r,i);else{var o=O(r)in n?O(r.slice(2)):O(r[2])+r.substring(3);((n.handlers||(n.handlers={}))[r=o]=i)?e||t.addListener(n,r,E):t.removeListener(n,r,E)}},B=function n(t,r){var e=3===t.type?d(t.name):(r=r||"svg"===t.name)?h.createElementNS("http://www.w3.org/2000/svg",t.name):"#document-fragment"===t.name?h.createDocumentFragment():y(t.name),i=t.props;for(var u in i)q(e,u,null,i[u],r);for(var o=0,f=t.children.length;o<f;o++)b(e,n(t.children[o],r));return t.node=e},D=function(n){return null==n?null:n.key},F=function(n){return n.t&&n.t(n),n},H=function(n,t,r,e,i,u){return{name:n,props:t,children:r,node:e,type:u,key:i}},J=function(n,t){return H(n,A,x,t,null,3)},P=function(n,t){return(n=function n(t,r,e,i,u){if(e===i);else if(null!=e&&3===e.type&&3===i.type)e.name!==i.name&&(r.nodeValue=i.name);else if(null==e||e.name!==i.name)r=k(t,B(i,u),r),null!=e&&j(t,F(e.node));else{var o,f,c,l,a=e.props,s=i.props,v=e.children,h=i.children,y=0,b=0,d=v.length-1,p=h.length-1;for(var m in u=u||"svg"===i.name,_(a,s)){var w=a[m],g=s[m];(["value","selected","checked"].includes(m)?r[m]:w)!==g&&q(r,m,w,g,u)}for(;b<=p&&y<=d&&null!=(c=D(v[y]))&&c===D(h[b]);)n(r,v[y].node,v[y++],h[b++],u);for(;b<=p&&y<=d&&null!=(c=D(v[d]))&&c===D(h[p]);)n(r,v[d].node,v[d--],h[p--],u);if(y>d)for(;b<=p;)k(r,B(h[b++],u),(f=v[y])&&f.node);else if(b>p)for(;y<=d;)j(r,F(v[y++].node));else{for(var O=y,A={},x={};O<=d;O++)null!=(c=v[O].key)&&(A[c]=v[O]);for(;b<=p;)c=D(f=v[y]),l=D(h[b]),x[c]||null!=l&&l===D(v[y+1])?(null==c&&j(r,F(f.node)),y++):null==l||1===e.type?(null==c&&(n(r,f&&f.node,f,h[b],u),b++),y++):(c===l?(n(r,f.node,f,h[b],u),x[l]=!0,y++):null!=(o=A[l])?(n(r,k(r,o.node,f&&f.node),o,h[b],u),x[l]=!0):n(r,f&&f.node,null,h[b],u),b++);for(;y<=d;)null==D(f=v[y++])&&j(r,F(f.node));for(var O in A)null==x[O]&&j(r,F(A[O].node))}}return i.node=r}(n.parentNode,n,n.vdom||function n(t){return 3===t.nodeType?J(t.nodeValue,t):H(O(t.nodeName),A,R.call(t.childNodes,n),t,null,1)}(n),t)).vdom=t,n},$=function(n,r){for(var e,i=[],u=[],o=arguments.length;o-- >2;)i.push(arguments[o]);for(;i.length>0;)if(t.isArray(e=i.pop()))for(o=e.length;o-- >0;)i.push(e[o]);else!1===e||!0===e||null==e||u.push(t.isObj(e)?e:J(e));return r=r||A,t.isFunc(n)?n(r,u):H(n,r,u,null,r.key)},z=Symbol(),I=Symbol(),L={},Z=function(n){function r(){var n;e(this,r),(n=s(this,o(r).call(this))).context=L,n.i=[],n.u={},n.state={},n.Host=function(t,r){for(var e in n.o=!0,_(t,n.u))q(a(n),e,n.u[e],t[e]);return n.u=t,$(S,{},r)},n.setState=function(r){t.extend(n.state,t.isFunc(r)?r(n.state):r||{}),n.update()},n.observeObi=function(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return r.forEach(function(t){return t.$onChange&&n.i.push(t.$onChange(n.update))})},n.update=function(){return n.l||(n.l=n.s.then(function(r){var e,i;r=[t.extend({Host:n.Host},n[z]),n.state,n.context],n.v?(i=n).p.apply(i,v(r)):(e=n).m.apply(e,v(r)),n.l=!1})),n.l},n.m=function(){for(var t,r,e=arguments.length,i=new Array(e),u=0;u<e;u++)i[u]=arguments[u];(t=n).willRender.apply(t,i);var o=(r=n).render.apply(r,i),f=y(n.o?"template":o.name);b(n.g,f),n.j=P(n.o?n.g:f,o);var c=function(){var t;n.classList.add("___"),(t=n).didRender.apply(t,i),n.i.push(n.lifeCycle()),n.v=!0};setTimeout(c)},n.p=function(){var t,r=n.willRender();(r||void 0===r)&&(P(n.o?n.g:n.j,(t=n).render.apply(t,arguments)),n.didRender())},n.t=function(t){t&&N(t),n.i.forEach(function(n){return n&&n()}),n.k=!0},n[z]={},n.render=n.render.bind(a(n)),n.s=new Promise(function(t){return n.O=t}),n.update();for(var i=n.constructor.A,u=i.length;u--;)i[u](a(n));return n}var f,c,h;return u(r,l(HTMLElement)),f=r,h=[{key:"observedAttributes",get:function(){var n=this,r=this.propTypes,e=this.prototype;return this.A=[],r?Object.keys(r).map(function(i){var u=function(n){return n.replace(/([A-Z])/g,"-$1").toLowerCase()}(i),o=r[i].name?{type:r[i]}:r[i];return i in e||t.def(e,i,{get:function(){return this[z][i]},set:function(n){var t=this,r=function(n,t){t=t||String;try{if(t==Boolean?n=[!0,1,"","1","true"].includes(n):"string"==typeof n&&(n=t==Number?Number(n):t==Object||t==Array?JSON.parse(n):n),{}.toString.call(n)=="[object ".concat(t.name,"]"))return{value:n,error:t==Number&&Number.isNaN(n)}}catch(n){}return{value:n,error:!0}}(n,o.type),e=r.value;if(r.error&&null!=e)throw"[".concat(i,"] must be type [").concat(o.type.name,"]");e!==this[z][i]&&(o.reflect&&this.s.then(function(){t[I]=u,g(t,u,o.type!==Boolean||e?e:null),t[I]=!1}),this[z][i]=e,this.update())}}),o.value&&n.A.push(function(n){return n[i]=o.value}),u}):[]}}],(c=[{key:"connectedCallback",value:function(){this.v||(this.attachShadow({mode:"open"}),this.g=this.shadowRoot||this,this.state.$onChange&&this.i.push(this.state.$onChange(this.update)),this.observe&&this.observeObi(this.observe),this.O())}},{key:"attributeChangedCallback",value:function(n,t,r){n!==this[I]&&t!==r&&(this[function(n){return n.replace(/-(\w)/g,function(n,t){return t.toUpperCase()})}(n)]=r)}},{key:"lifeCycle",value:function(){}},{key:"willRender",value:function(){}},{key:"render",value:function(){}},{key:"didRender",value:function(){}},{key:"disconnectedCallback",value:function(){!this.k&&this.t()}}])&&i(f.prototype,c),h&&i(f,h),r}(),G=function(n,t,r){var i,f;return function(n){w("".concat(n," {visibility:hidden}"))}(n),customElements.define(n,t.prototype instanceof Z?t:(f=i=function(n){function r(){var n,i;e(this,r);for(var u=arguments.length,f=new Array(u),c=0;c<u;c++)f[c]=arguments[c];return(i=s(this,(n=o(r)).call.apply(n,[this].concat(f)))).render=t,i}return u(r,Z),r}(),i.propTypes=r,f)),function(t,r){return $(n,t,r)}};n.Fragment=function(n,t){return t},n.Xelement=Z,n.context=L,n.element=G,n.globalStyles=m,n.h=$,n.provide=function(n,e){var i=t.isFunc(e)?r.obi(e(L)):t.isObj(e)?r.obi(e):e;return L[n]=i,i},n.x=function(n,t,r){return G("x-"+n,t,r)},Object.defineProperty(n,"R",{value:!0})});
