import{toLowerCase as t,isArray as e,isObj as s,isFunc as i,objectIsEmpty as l,removeListener as n,addListener as r,updateAttribute as h,createTextNode as o,d as u,createElement as f,appendChild as a,isString as c,IS_NON_DIMENSIONAL as d,webComponentVisibilityStyleSheet as p,COMPONENT_MOUNTED_ATTRIBUTE as v,CONSTRUCTABLE_STYLE_SHEETS_AVAILABLE as b,extend as m,attrToProp as y,propToAttr as g,def as w,formatType as S,webComponentVisibility as C,raf as k,tagStyleCache as x,globalStyles as R,CSSTextToObj as j}from"./utils.js";export{globalStyles}from"./utils.js";var E=(t,e)=>t.removeChild(e),M=(t,e,s)=>t.insertBefore(e,s),T={},U=[],A=U.map,H="#document-fragment",z=(t,e)=>e,B=function(t){this.handlers[t.type](t)},F=t=>{if(!l(t.handlers))for(let e in t.handlers)n(t,e,B),delete t.handlers[e]},L=t=>{F(t),[].concat(...t.childNodes).forEach(t=>{F(t),L(t)})},N=(t,e,s,i)=>{"-"===e[0]?t.setProperty(e,s):t[e]=i?s:((t,e)=>"number"==typeof e&&!1===d.test(t)?e+"px":e)(e,s)},O=(t,e,i)=>(t=>(t=>t?t.split(/\s+/).filter(t=>t):[])(s(t)?((t,e)=>{e="";for(let s in t)t[s]&&(e+=(e&&" ")+s);return e})(t):t))(e).forEach(e=>t.classList[i](e)),P=(e,s,l,o,u)=>{if("key"===s);else if(!s.startsWith("on")||s in e)"ref"===s&&i(o)?o(e):"style"===s?((t,s,i)=>{let l=e.style;if(c(s))return l.cssText=s;if(c(i)&&(l.cssText="",i=null),i)for(let t in i)s&&t in s||N(l,t,"");if(s)for(let t in s)i&&s[t]===i[t]||N(l,t,s[t])})(0,o,l):"className"===s||"class"===s?(O(e,l,"remove"),O(e,o,"add")):!u&&"list"!==s&&s in e?e[s]=null==o?"":o:h(e,s,o);else{let i=t(s)in e?t(s.slice(2)):t(s[2])+s.substring(3);o?(l||r(e,i,B),(e.handlers||(e.handlers={}))[i]=o):n(e,i,B)}},$=(t,e)=>{var s=3===t.type?o(t.name):(e=e||"svg"===t.name)?u.createElementNS("http://www.w3.org/2000/svg",t.name):t.name===H?u.createDocumentFragment():f(t.name),i=t.props;for(var l in i)s.nodeName!==H&&P(s,l,null,i[l],e);for(var n=0,r=t.children.length;n<r;n++)a(s,$(t.children[n],e));return t.node=s},q=t=>null==t?null:t.key,D=t=>(L(t),t.destroy&&t.destroy(t),t),G=(t,e,s,i,l)=>{if(s===i);else if(null!=s&&3===s.type&&3===i.type)s.name!==i.name&&(e.nodeValue=i.name);else if(null==s||s.name!==i.name)e=M(t,$(i,l),e),null!=s&&E(t,D(s.node));else{var n,r,h,o,u=s.props,f=i.props,a=s.children,c=i.children,d=0,p=0,v=a.length-1,b=c.length-1;for(var m in l=l||"svg"===i.name,((t,e,s)=>{for(var i in s={},t)s[i]=t[i];for(var i in e)s[i]=e[i];return s})(u,f)){var y=u[m],g=f[m];(["value","selected","checked"].includes(m)?e[m]:y)!==g&&i.name!==H&&P(e,m,y,g,l)}for(;p<=b&&d<=v&&null!=(h=q(a[d]))&&h===q(c[p]);)G(e,a[d].node,a[d++],c[p++],l);for(;p<=b&&d<=v&&null!=(h=q(a[v]))&&h===q(c[b]);)G(e,a[v].node,a[v--],c[b--],l);if(d>v)for(;p<=b;)M(e,$(c[p++],l),(r=a[d])&&r.node);else if(p>b)for(;d<=v;)E(e,D(a[d++].node));else{for(var w=d,S={},C={};w<=v;w++)null!=(h=a[w].key)&&(S[h]=a[w]);for(;p<=b;)h=q(r=a[d]),o=q(c[p]),C[h]||null!=o&&o===q(a[d+1])?(null==h&&E(e,D(r.node)),d++):null==o||1===s.type?(null==h&&(G(e,r&&r.node,r,c[p],l),p++),d++):(h===o?(G(e,r.node,r,c[p],l),C[o]=!0,d++):null!=(n=S[o])?(G(e,M(e,n.node,r&&r.node),n,c[p],l),C[o]=!0):G(e,r&&r.node,null,c[p],l),p++);for(;d<=v;)null==q(r=a[d++])&&E(e,D(r.node));for(var w in S)null==C[w]&&E(e,D(S[w].node))}}return i.node=e},I=(t,e,s,i,l,n)=>({name:t,props:e,children:s,node:i,type:n,key:l}),J=(t,e)=>I(t,T,U,e,null,3),K=e=>3===e.nodeType?J(e.nodeValue,e):I(t(e.nodeName),T,A.call(e.childNodes,K),e,null,1),Q=(t,e)=>((t=G(t.parentNode,t,t.vdom||K(t),e)).vdom=e,t),V=function(t,l){for(var n,r=[],h=[],o=arguments.length;o-- >2;)r.push(arguments[o]);for(;r.length>0;)if(e(n=r.pop()))for(o=n.length;o-- >0;)r.push(n[o]);else!1===n||!0===n||null==n||h.push(s(n)?n:J(n));return l=l||T,i(t)?t(l,h):I(t,l,h,null,l.key)};let W="props",X=Symbol(),Y=":host, *, *::before, *::after {box-sizing: border-box;} ",Z={};const _=(t,e)=>Z[t]=e;p(`[${v}] {visibility: inherit;}`);class tt extends HTMLElement{constructor(){super(),this.context=Z,this.t=[],this.state={};let{initAttrs:t,shadow:n,rootSheet:r,noRerender:o,tag:u}=this.constructor,c=n?this.attachShadow({mode:["open","closed"].includes(n)?n:"open"}):this;this[W]={},this.render=this.render.bind(this),this.mounted=new Promise(t=>this.s=t);const d=t=>{let s=n?c:document,i="";return t.forEach(t=>{if(b){let i=e(t)?t[0]:t;i&&![].concat(s.adoptedStyleSheets).includes(i)&&(s.adoptedStyleSheets=[...s.adoptedStyleSheets,i])}else e(t)&&t[1]&&(i+=t[1])}),i};b&&d([r]);let p=!1;const y=({css:t,noResets:i,globalFallback:l,useStyleTag:h,styleSheets:o},f)=>{let a=t||s(f[0])&&f[0].name||"";!i&&n&&(a=Y+a);let c="";return b&&!p&&e(o)&&(c=d(o),p=!0),b||!l||x[u]?!b||h?V("style",null,a+c):0===r.cssRules.length?(r.replaceSync(a),null):null:(x[u]=!0,R(a+c),null)};let g,w;const S=(t,e)=>{g=!0;let s=V(H,{},e);if(!this.hasMounted&&l(t))return w=!0,s;if(w&&l(t))return s;w=!1;let i={},n=0,r=this.attributes;for(n=r.length;n--;){let t=r[n].name;i["class"===t?"className":t]=r[n].value}for(let e in t)P(this,e,i[e],t[e]);return s};this.setState=t=>(m(this.state,i(t)?t(this.state):t||{}),this.update()),this.observeObi=(...t)=>t.forEach(t=>t.$onChange&&this.t.push(t.$onChange(this.update)));const C=()=>(this.i&&(this[W].style=j(this.style.cssText)),[m({Host:S,CSS:y,host:this},this[W]),this.state,this.context]);let E,M;const T=()=>{let t=C();this.willMount(...t),this.willRender(...t);let e=this.render(...t);if(e){let t=f(g?"template":e.name);a(c,t),E=Q(g&&n?c:t,e)}else M=!0;this.hasMounted=!0,k(()=>{this.t.push(this.lifeCycle()),h(this,v,""),this.didRender(...t),this.didMount(...t)})},U=()=>{let t=C(),e=this.willRender(...t);this.shouldUpdate&&(e=this.shouldUpdate(...t)),o||M||!e&&void 0!==e||(this.willUpdate(...t),Q(g&&n?c:E,this.render(...t)),this.didUpdate(...t),this.didRender(...t))};let A;this.update=()=>(this.processing||(this.processing=this.mounted.then(t=>{this.hasMounted?U():T(),this.processing=!1})),this.processing),this.emit=(t,e,s,i)=>(s||this).dispatchEvent(new CustomEvent(t,m({detail:e,bubbles:!0,composed:!0},i||{}))),this.destroy=t=>{A||(t&&L(t),this.t.forEach(t=>i(t)&&t()),A=!0)};let z=t.length;for(;z--;)t[z](this);this.update()}connectedCallback(){this.hasMounted||(this.state.$onChange&&this.t.push(this.state.$onChange(this.update)),this.observe&&this.observeObi(this.observe),this.s())}disconnectedCallback(){this.isConnected||(this.willUnmount(),this.destroy())}attributeChangedCallback(t,e,s){this[X]!==t&&e!==s&&("style"===t&&this.i?this.update():this[y(t)]=s)}static get observedAttributes(){let{propTypes:t,prototype:e}=this;if(this.initAttrs=[],!t)return[];let s=Object.keys(t).map(s=>{let i=g(s),l=t[s].name?{type:t[s]}:t[s];return s in e||w(e,s,{get(){return this[W][s]},set(t){let{value:e,error:n}=S(t,l.type);e!==this[W][s]&&(l.reflect&&this.mounted.then(()=>{this[X]=i,h(this,i,l.type!==Boolean||e?e:null),this[X]=!1}),this[W][s]=e,this.update())}}),l.value&&this.initAttrs.push(t=>t[s]=l.value),i});return this.prototype.i=s.includes("style"),s}willMount(){}willRender(){}render(){}didRender(){}willUpdate(){}didUpdate(){}didMount(){}lifeCycle(){}willUnmount(){}}const et=(t,e,s)=>{var i,l;s=s||{},C(t);let n,r=e.prototype instanceof tt;return b&&(n=new CSSStyleSheet),r&&(e.rootSheet=n,e.tag=t),customElements.define(t,r?e:(l=i=class extends tt{constructor(...t){super(...t),this.render=e}},i.tag=t,i.propTypes=s.propTypes,i.shadow=s.shadow,i.rootSheet=n,i.noRerender=s.noRerender,l)),(e,s)=>V(t,e,s)};export{tt as Component,z as Fragment,V as h,Q as patch,_ as provide,et as x};
//# sourceMappingURL=index.js.map
